sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/library","sap/ui/unified/library","sap/ui/comp/smartvariants/PersonalizableInfo","sap/m/MessageToast","sap/ui/core/BusyIndicat+
or"],function(e,t,s,a,o,r,n,i,l){"use strict";var c=r.CalendarDayType,d=o.ValueState;return e.extend("zspoc06.controller.View1",{onInit:function(){window.view1=this;this.oExpandedLabel=this.getView().byId("expandedLabel");this.oSnappedLabel=this.getView(+
).byId("snappedLabel");this.oSmartVariantManagement=this.byId("svm");this.oFilterBar=this.byId("filterbar");var e=new n({type:"filterBar",keyName:"persistencyKey",dataSource:"",control:this.oFilterBar});this.oSmartVariantManagement.addPersonalizableContr+
ol(e);this.oSmartVariantManagement.initialise(function(){},this.oFilterBar);l.hide()},rowSelectionChange:function(e){var t=this.byId("salesTable").getSelectedIndices();this.sPath=e.getParameters().rowContext.sPath;if(t.length!=0){this.byId("rePricingLink+
").setEnabled(true);this.byId("rejectAllLink").setEnabled(true)}else{this.byId("rePricingLink").setEnabled(false);this.byId("rejectAllLink").setEnabled(false)}},onPressPricing:function(){this.pricingDatePicker=new sap.m.DatePicker({});var e=this;var s=th+
is.sPath;var a=window.zspoc06.getView().getModel("salesList").getProperty(s+"/SalesOrderNumber");var o="'"+String(a.padStart(10,"0"))+"'";t.confirm(new sap.m.VBox({items:[new sap.m.Text({text:"Prising Date: "}).addStyleClass(""),this.pricingDatePicker]})+
,{title:"Re-Prising",actions:["Re-Prising","Cancel"],onClose:function(t){if(t=="Re-Prising"){var s=e.pricingDatePicker.getDateValue();console.log(s);if(s==null){return}l.show();s.setHours(s.getHours()+9);var a=s;var r=a.getFullYear()+"-"+(a.getMonth()+1)+
.toString().padStart(2,"0")+"-"+a.getDate().toString().padStart(2,"0");var n="datetime'"+r+"T00:00'";const t=new XMLHttpRequest;const c=new XMLHttpRequest;c.open("GET","http://20.194.41.230:50000/sap/opu/odata/sap/ZSPOC06_03_C_SOLIST_B_V2",true);c.setReq+
uestHeader("Authorization","Basic c3BvYzA2OlNwb2MwNiEh");c.setRequestHeader("X-Requested-With","XMLHttpRequest");c.setRequestHeader("x-csrf-token","fetch");c.send();c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200||c.status==201){cons+
ole.log("[status2] : "+c.status);console.log("[response2] : "+"[success]");console.log("[response2] : "+c.responseText);console.log("")}else{console.log("[status] : "+c.status);console.log("[response] : "+"[fail]");console.log("[response] : "+c.responseT+
ext);console.log("");i.show(c.status);l.hide()}}};c.onload=()=>{if(c.readyState==4){if(c.status==200||c.status==201){console.log("[statusOnload] : "+c.status);console.log("[responseOnload] : "+"[success3]");console.log("[responseOnload] : "+c.responseTex+
t);console.log("[AllheadersOnload] : "+c.getAllResponseHeaders());console.log("");var e="http://20.194.41.230:50000/sap/opu/odata/sap/ZSPOC06_03_SOLIST_B_V2/rePricing?SalesOrderNumber="+o+"&pricingdate="+n;var s=decodeURI(e);t.open("POST",s,true);t.setRe+
questHeader("Content-Type","text/plain;charset=UTF-8");t.setRequestHeader("Authorization","Basic c3BvYzA2OlNwb2MwNiEh");t.setRequestHeader("X-Requested-With","XMLHttpRequest");t.setRequestHeader("x-csrf-token",c.getResponseHeader("x-csrf-token"));t.setRe+
questHeader("Accept-Language","euc-kr");t.setRequestHeader("Accept","application/json");t.send();console.log("[statusPOST] : "+t.status);console.log("[response2POST] : "+t.responseText);console.log("[AllResponseHeadersPOST] : "+t.getAllResponseHeaders())+
;console.log("")}else{alert("ERROR LOADING FILE!"+c.status);i.show("err");i.show(c.status);l.hide()}}};t.onreadystatechange=function(){if(t.readyState==4){if(t.status==200||t.status==201){var e=t.getResponseHeader("sap-message").trim().split("\r\n")[0];v+
ar s=e.split('"message":"')[1];var a=s.split('","target')[0];i.show(a,{duration:5e3});l.hide();console.log("[statusPost] : "+t.status);console.log("[responsePost] : "+"[success]");console.log("[responsePost] : "+t.responseText);console.log("")}else{conso+
le.log("[status] : "+t.status);console.log("[response] : "+"[fail]");console.log("[response] : "+t.responseText);console.log("");i.show(t.status);l.hide()}}}}}})},onPressRejectAll:function(){console.log("reject all");this.rejectDatePicker=new sap.m.DateP+
icker({});var e=new sap.ui.model.json.JSONModel;e.setData({values:window.zspoc06.getView().getModel("rejectReason").oData});sap.ui.getCore().setModel(e);this.recjectCombo=new sap.m.ComboBox({width:"143%"});this.recjectCombo.bindProperty("tooltip","/toolt+
ip");this.recjectCombo.setModel(e);var s=new sap.ui.core.ListItem;s.bindProperty("key","Status");s.bindProperty("text","comboText");this.recjectCombo.bindItems("/values",s);var a=this;var o=this.sPath;var r=window.zspoc06.getView().getModel("salesList").+
getProperty(o+"/SalesOrderNumber");var n="'"+String(r.padStart(10,"0"))+"'";var c;t.confirm(new sap.m.VBox({items:[new sap.m.Text({text:"Prising Date: "}).addStyleClass(""),this.rejectDatePicker,new sap.m.Text({text:"Reason for Rejection: "}).addStyleCla+
ss(""),this.recjectCombo]}),{title:"Reject All",actions:["Reject All","Cancel"],onClose:function(e){if(e=="Reject All"){c="'"+window.view1.recjectCombo.getSelectedKey()+"'";var t=a.rejectDatePicker.getDateValue();if(t==null||c==""){return}l.show();t.setH+
ours(t.getHours()+9);var s=t;var o=s.getFullYear()+"-"+(s.getMonth()+1).toString().padStart(2,"0")+"-"+s.getDate().toString().padStart(2,"0");var r="datetime'"+o+"T00:00'";const e=new XMLHttpRequest;const d=new XMLHttpRequest;d.open("GET","http://20.194.+
41.230:50000/sap/opu/odata/sap/ZSPOC06_03_SOLIST_B_V2");d.setRequestHeader("Authorization","Basic c3BvYzA2OlNwb2MwNiEh");d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.setRequestHeader("x-csrf-token","FETCH");d.send();d.onreadystatechange=func+
tion(){if(d.readyState==4){if(d.status==200||d.status==201){console.log("[statusReject All] : "+d.status);console.log("[responseReject All] : "+"[success]");console.log("[responseReject All] : "+d.responseText);console.log("")}else{console.log("[statusRe+
ject All] : "+d.status);console.log("[responseReject All] : "+"[fail]");console.log("[responseReject All] : "+d.responseText);console.log("");i.show(d.status);l.hide()}}};d.onload=()=>{if(d.readyState==4){if(d.status==200||d.status==201){console.log("[st+
atus3] : "+d.status);console.log("[response3] : "+"[success3]");console.log("[response3] : "+d.responseText);console.log("[Allheaders3] : "+d.getAllResponseHeaders());console.log("");var t="http://20.194.41.230:50000/sap/opu/odata/sap/ZSPOC06_03_SOLIST_B+
_V2/rejectAll?SalesOrderNumber="+n+"&pricingdate="+r+"&rejectreason="+c;var s=decodeURI(t);console.log(s);e.open("POST",s,true);e.setRequestHeader("content-type","text/html");e.setRequestHeader("Authorization","Basic c3BvYzA2OlNwb2MwNiEh");e.setRequestHe+
ader("X-Requested-With","XMLHttpRequest");e.setRequestHeader("x-csrf-token",d.getResponseHeader("x-csrf-token"));e.setRequestHeader("Accept-Language","euc-kr");e.setRequestHeader("Accept","application/json");e.send();console.log("[statusPOST] : "+e.statu+
s);console.log("[responsePOST] : "+e.responseText);console.log("[AllResponseHeadersPOST] : "+e.getAllResponseHeaders());console.log("")}else{alert("ERROR LOADING FILE!"+d.status);i.show(d.status);l.hide()}}};e.onreadystatechange=function(t){if(e.readySta+
te==4){if(e.status==200||e.status==201){var s=e.getResponseHeader("sap-message").trim().split("\r\n")[0];var a=s.split('"message":"')[1];var o=a.split('","target')[0];i.show(o,{duration:5e3});l.hide();console.log("[statusPostReject All] : "+e.status);con+
sole.log("[responsePostReject All] : "+"[success]");console.log("[responsePostReject All] : "+e.responseText);console.log("[responsePostReject All] : "+e.responseText);console.log("")}else{i.show("err");console.log("[statusReject All] : "+e.status);conso+
le.log("[responseReject All] : "+"[fail]");console.log("[responseReject All] : "+e.responseText);console.log("");i.show(e.status);l.hide()}}}}}})},liveSearch:function(e){this.oExpandedLabel.setText(this.getFormattedSummaryTextExpanded());this.oSnappedLab+
el.setText(this.getFormattedSummaryText());this.onSearch()},handleChange:function(e){var t=e.getSource(),s=e.getParameter("value"),a=e.getParameter("valid");this._iEvent++;if(a){t.setValueState(d.None)}else{t.setValueState(d.Error)}},tokenUpdate:function+
(e){this.oExpandedLabel.setText(this.getFormattedSummaryTextExpanded());this.oSnappedLabel.setText(this.getFormattedSummaryText());var t=this.byId("salesTable");t.setShowOverlay(true)},onFilterChange:function(e){this.oExpandedLabel.setText(this.getFormat+
tedSummaryTextExpanded());this.oSnappedLabel.setText(this.getFormattedSummaryText());var t=this.byId("salesTable");t.setShowOverlay(true)},onSearch:function(){var e=this.aFilter();var t=this.byId("salesTable");var s=t.getBinding();s.filter(e);t.setShowOv+
erlay(false)},dateFormat:function(e){if(e==null){return""}var t=e;return t.getFullYear()+". "+t.getMonth().toString().padStart(2,"0")+". "+t.getDate().toString().padStart(2,"0")+". "},getFormattedSummaryText:function(){var e=this.aFilter();var t=this.aCa+
tegory();if(e.length===0){return"No filters active"}if(e.length===1){return e.length+" filter active: "+t.join(", ")}return e.length+" filters active: "+t.join(", ")},getFormattedSummaryTextExpanded:function(){var e=this.aFilter();if(e.length===0){return+
"No filters active"}var t=e.length+" filters active",s=this.hiddenFilter();if(e.length===1){t=e.length+" filter active"}if(s&&s.length>0){t+=" ("+s.length+" hidden)"}return t},aFilter:function(){var e=this.byId("filterbar");var t=e.getFilterItems();var o+
=[];for(var r of t){var n=e.determineControlByFilterItem(r);var i;if(n.getId()=="container-zspoc06---View1--oSearch"){var l=this.byId("oSearch").getValue();if(l){o.push(new s({filters:[new s("OrderType",a.Contains,l),new s("SalesOrderNumber",a.Contains,l+
),new s("SalesOrganization",a.Contains,l),new s("DistChannel",a.Contains,l),new s("Division",a.Contains,l),new s("SalesOffice",a.Contains,l),new s("SalesGroup",a.Contains,l),new s("RejectionStatus",a.Contains,l),new s("StatusOfStatic",a.Contains,l),new s+
("DeliverStatus",a.Contains,l),new s("CreatedBy",a.Contains,l),new s("CustomerName",a.Contains,l),new s("OrderType",a.Contains,l)],and:false}))}}else{if(n.getFilter().aFilters){var c=[];for(var d of n.getFilter().aFilters){c.push(new s(d.sPath,d.sOperato+
r,d.oValue1))}o.push(new s({filters:c,and:false}))}}}return o},hiddenFilter:function(){var e=this.byId("filterbar");var t=[];var s=e._mAdaptFiltersDialogInitialItemsOrder;for(var a of s){if(a.filterItem.mProperties.visibleInFilterBar==false){t.push(a.fil+
terItem.mProperties.name)}}return t},aCategory:function(){var e=this.byId("filterbar");var t=e.getFilterItems();var s=[];for(var a of t){var o=e.determineControlByFilterItem(a);if(o.getId()=="container-zspoc06---View1--oSearch"){var r=this.byId("oSearch"+
).getValue();if(r){s.push(a.getName())}}else{if(o.getFilter().aFilters){s.push(a.getName())}}}return s}})});                                                                                                                                                   